"use strict";(()=>{var e={};e.id=884,e.ids=[884],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},2048:e=>{e.exports=require("fs")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},1659:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>h,requestAsyncStorage:()=>y,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{GET:()=>d,dynamic:()=>p});var i=r(9303),s=r(8716),n=r(670),o=r(7070),u=r(2663),c=r(6497);let p="force-dynamic",l=()=>u._.music.findMany({orderBy:{createdAt:"desc"}});async function d(){try{let e=await l(),t=await Promise.all(e.map(async e=>{let t=await (0,c.qm)(e.cloud_storage_path),r=e.cover_image_path?await (0,c.qm)(e.cover_image_path):null;return{id:String(e.id),title:e.title,artist:e.artist,url:t,coverUrl:r,duration:e.duration??0}}));return o.NextResponse.json({musics:t})}catch(e){return console.error("List error:",e),o.NextResponse.json({error:"Erro ao listar m\xfasicas"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/music/list/route",pathname:"/api/music/list",filename:"route",bundlePath:"app/api/music/list/route"},resolvedPagePath:"/home/ubuntu/code_artifacts/producoes.agmusic/app/api/music/list/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:w}=m,x="/api/music/list/route";function h(){return(0,n.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:f})}},2663:(e,t,r)=>{r.d(t,{_:()=>i});let a=require("@prisma/client"),i=globalThis.prisma??new a.PrismaClient},6497:(e,t,r)=>{r.d(t,{_I:()=>p,qm:()=>c,cT:()=>u});let a=require("@aws-sdk/client-s3");var i=r(9710);let s=new a.S3Client({}),{bucketName:n,folderPrefix:o}={bucketName:process.env.AWS_BUCKET_NAME,folderPrefix:process.env.AWS_FOLDER_PREFIX||""};async function u(e,t,r="audio/mpeg"){let i=`${o}music/${Date.now()}-${t}`;return await s.send(new a.PutObjectCommand({Bucket:n,Key:i,Body:e,ContentType:r})),i}async function c(e,t=3600){let r=new a.GetObjectCommand({Bucket:n,Key:e});return await (0,i.e)(s,r,{expiresIn:t})}async function p(e){await s.send(new a.DeleteObjectCommand({Bucket:n,Key:e}))}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,97],()=>r(1659));module.exports=a})();